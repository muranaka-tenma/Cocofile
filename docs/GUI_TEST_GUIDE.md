# CocoFile - GUI動作確認テストガイド

**作成日**: 2025年11月5日
**目的**: Windows/macOS/Linuxデスクトップ環境でのGUI実動作テスト
**前提条件**: MVP 100%完了、バックエンド実装完了

---

## 📋 テスト概要

### 目的
- フロントエンド↔バックエンドの実際の連携動作を確認
- 全5画面の表示と操作性を確認
- ホットキー機能の動作を確認
- 実際のファイルでエンドツーエンドのテストを実施

### 対象環境
- **Windows 10/11** (推奨)
- **macOS** (Catalina以降)
- **Linux Desktop** (Ubuntu/Fedora等)

### 所要時間
約30-45分

---

## 🚀 事前準備

### 1. 環境確認

#### Windows環境
```powershell
# PowerShellで実行
rustc --version
node --version
python --version
```

#### macOS/Linux環境
```bash
rustc --version
node --version
python3 --version
```

### 2. プロジェクトディレクトリへ移動

```bash
cd /path/to/CocoFile
```

### 3. 依存関係の確認

```bash
# フロントエンド依存関係
cd frontend
npm install

# Rustバックエンド
cd ../src-tauri
cargo check
```

---

## 🎯 テスト手順

### Phase 1: 開発サーバー起動テスト

#### 手順1-1: Tauri Dev起動

**Windows (PowerShell)**:
```powershell
cd frontend
npm run tauri:dev
```

**macOS/Linux**:
```bash
cd frontend
npm run tauri:dev
```

#### 期待される動作
1. Vite開発サーバーが起動（http://localhost:5173）
2. Rustバックエンドがコンパイル
3. デスクトップウィンドウが自動的に開く
4. ウィンドウサイズ: 1200x800px
5. タイトル: "CocoFile"

#### チェック項目
- [ ] Vite起動成功（5-10秒以内）
- [ ] Rustコンパイル成功（初回: 1-3分、2回目以降: 数秒）
- [ ] デスクトップウィンドウが表示される
- [ ] ウィンドウタイトルが "CocoFile"
- [ ] ウィンドウがリサイズ可能
- [ ] コンソールにエラーがない

#### トラブルシューティング

**問題1: ウィンドウが表示されない**
- WSL2環境の場合: X11サーバー（VcXsrv等）が必要
- macOSの場合: 初回起動時にセキュリティ許可が必要
- Windowsの場合: ファイアウォール設定を確認

**問題2: Viteが起動しない**
```bash
cd frontend
rm -rf node_modules package-lock.json
npm install
npm run tauri:dev
```

**問題3: Rustコンパイルエラー**
```bash
cd src-tauri
cargo clean
cargo check
```

---

### Phase 2: 画面表示テスト（5画面）

#### 画面S-001: メイン検索画面

**確認項目**:
- [ ] 検索ボックスが表示される
- [ ] フィルター（日付、タイプ、タグ）が表示される
- [ ] 検索結果エリアが表示される
- [ ] プレビューエリアが表示される
- [ ] UIが正しくレイアウトされている

**操作テスト**:
1. 検索ボックスに「テスト」と入力
2. フィルターをクリックして展開
3. 検索結果が空の場合、「ファイルが見つかりませんでした」が表示されるか確認

#### 画面S-002: 設定画面

**確認項目**:
- [ ] 「設定」タブが表示される
- [ ] 監視フォルダ設定セクションが表示される
- [ ] UI設定セクションが表示される
- [ ] タグ辞書セクションが表示される
- [ ] 保存ボタンが表示される

**操作テスト**:
1. 画面上部の「設定」リンクをクリック
2. 各セクションが正しく表示されるか確認
3. フォルダ追加ボタンをクリック
4. 保存ボタンをクリック（動作確認）

#### 画面S-003: スキャン・インデックス管理画面

**確認項目**:
- [ ] 「スキャン」タブが表示される
- [ ] 手動スキャンボタンが表示される
- [ ] 進捗表示エリアが表示される
- [ ] インデックス統計が表示される
- [ ] 重複ファイル検出エリアが表示される

**操作テスト**:
1. 画面上部の「スキャン」リンクをクリック
2. 「フォルダを選択」ボタンをクリック
3. フォルダ選択ダイアログが開くか確認

#### 画面S-004: タグ管理画面

**確認項目**:
- [ ] 「タグ管理」タブが表示される
- [ ] タグ一覧が表示される
- [ ] タグ追加ボタンが表示される
- [ ] タグ編集機能が利用可能
- [ ] タグカラー設定が表示される

**操作テスト**:
1. 画面上部の「タグ管理」リンクをクリック
2. 「新しいタグを追加」ボタンをクリック
3. タグ名入力フィールドが表示されるか確認
4. カラーピッカーが動作するか確認

#### 画面S-005: ファイル詳細モーダル

**確認項目**:
- [ ] モーダルが表示される（トリガー必要）
- [ ] ファイル情報が表示される
- [ ] プレビューエリアが表示される
- [ ] タグ編集エリアが表示される
- [ ] 閉じるボタンが動作する

**操作テスト**:
1. メイン検索画面でファイルを選択（存在する場合）
2. モーダルが開くか確認
3. 閉じるボタンで閉じるか確認

---

### Phase 3: ホットキー機能テスト

#### テスト内容
グローバルショートカット（Ctrl+Shift+F / Cmd+Shift+F）の動作確認

#### 手順
1. CocoFileウィンドウを表示した状態で **Ctrl+Shift+F** (Windows/Linux) または **Cmd+Shift+F** (macOS) を押す
2. ウィンドウが非表示になるか確認
3. もう一度 **Ctrl+Shift+F** / **Cmd+Shift+F** を押す
4. ウィンドウが再表示され、フォーカスが当たるか確認

#### チェック項目
- [ ] 初回: ウィンドウが非表示になる
- [ ] 2回目: ウィンドウが再表示される
- [ ] 再表示時にフォーカスが当たる
- [ ] 他のアプリを使用中でも動作する
- [ ] トグル動作が安定している

---

### Phase 4: バックエンド連携テスト

#### テスト4-1: データベース初期化

**確認方法**:
開発者ツールのコンソールを開く（F12 または Cmd+Option+I）

**期待されるログ**:
```
[INFO] Database: Initialized successfully
[INFO] PythonBridge: Initialized successfully
[INFO] Shortcut: Global shortcut (Ctrl+Shift+F) registered
```

#### チェック項目
- [ ] データベース初期化成功メッセージ
- [ ] Pythonブリッジ初期化成功メッセージ
- [ ] ショートカット登録成功メッセージ
- [ ] エラーログがない

#### テスト4-2: Pythonヘルスチェック

**手順**:
1. 開発者ツールのコンソールで実行:
```javascript
// Tauri APIを使用してヘルスチェック
const { invoke } = window.__TAURI__.core;
invoke('python_health_check').then(console.log).catch(console.error);
```

**期待される結果**:
```json
"Python backend is healthy"
```

#### チェック項目
- [ ] ヘルスチェック成功
- [ ] エラーが発生しない

---

### Phase 5: ファイル分析E2Eテスト

#### 事前準備: テストファイルの配置

テストファイルを準備:
```bash
# プロジェクトルートから
ls test_files/
# 期待される出力:
# 売上データ2024.xlsx
# 営業報告2024.pptx
# 提案書.txt
# 営業資料.txt
```

#### テスト5-1: ディレクトリスキャン

**手順**:
1. CocoFileアプリで「スキャン」画面に移動
2. 「フォルダを選択」ボタンをクリック
3. `test_files` フォルダを選択
4. 「スキャン開始」ボタンをクリック

**期待される動作**:
- 進捗表示が更新される
- スキャン完了後、「4ファイルをインデックス化しました」と表示される
- エラーが発生しない

#### チェック項目
- [ ] フォルダ選択ダイアログが開く
- [ ] スキャン進捗が表示される
- [ ] スキャン完了メッセージが表示される
- [ ] インデックス統計が更新される

#### テスト5-2: ファイル検索

**手順**:
1. メイン検索画面に戻る
2. 検索ボックスに「売上」と入力
3. Enterキーまたは検索ボタンをクリック

**期待される結果**:
- `売上データ2024.xlsx` が検索結果に表示される
- ファイル名、パス、サイズが正しく表示される
- スニペット（プレビュー）が表示される

#### チェック項目
- [ ] 検索が実行される（0.5秒以内）
- [ ] 結果が表示される
- [ ] ファイル情報が正しい
- [ ] N-gram検索が動作している（部分一致）

#### テスト5-3: ファイル詳細表示

**手順**:
1. 検索結果から `売上データ2024.xlsx` をクリック
2. ファイル詳細モーダルが開く
3. ファイル情報を確認

**期待される表示内容**:
- ファイル名: 売上データ2024.xlsx
- ファイルサイズ: 4,987 bytes
- 分析結果: シート名、セル値
- タグエリア

#### チェック項目
- [ ] モーダルが開く
- [ ] ファイル情報が正しい
- [ ] 分析結果が表示される
- [ ] タグエリアが動作する

---

## 📊 テスト結果記録

### テスト実施情報

| 項目 | 情報 |
|------|------|
| テスト実施日 | YYYY-MM-DD |
| テスト実施者 | [名前] |
| テスト環境OS | Windows 11 / macOS / Linux |
| Rustバージョン | [バージョン] |
| Node.jsバージョン | [バージョン] |
| Pythonバージョン | [バージョン] |

### テスト結果サマリー

| カテゴリ | テスト項目数 | 合格 | 不合格 | 備考 |
|---------|-----------|------|--------|------|
| Phase 1: 開発サーバー起動 | 6 | [ ] | [ ] | |
| Phase 2: 画面表示（5画面） | 20 | [ ] | [ ] | |
| Phase 3: ホットキー | 5 | [ ] | [ ] | |
| Phase 4: バックエンド連携 | 5 | [ ] | [ ] | |
| Phase 5: E2Eテスト | 10 | [ ] | [ ] | |
| **合計** | **46** | **[ ]** | **[ ]** | |

### 発見された問題

#### 問題1
- **カテゴリ**: [Phase番号]
- **重要度**: 高 / 中 / 低
- **現象**: [問題の詳細]
- **再現手順**:
  1.
  2.
- **スクリーンショット**: [パス]
- **対応状況**: 未対応 / 対応中 / 完了

---

## ✅ テスト完了基準

以下の全項目が満たされた場合、テスト合格とする:

### 必須項目（全て合格必須）
- [ ] 開発サーバーが正常に起動する
- [ ] 全5画面が表示される
- [ ] ホットキーが動作する
- [ ] データベース初期化が成功する
- [ ] Pythonブリッジが動作する
- [ ] ファイルスキャンが成功する
- [ ] 検索機能が動作する

### 推奨項目（80%以上合格）
- [ ] 画面レイアウトが正しい
- [ ] UI操作が快適
- [ ] エラーハンドリングが適切
- [ ] パフォーマンスが目標値内

---

## 🚀 次のステップ

### テスト合格後
1. **クロスプラットフォームビルド**
   - macOS用バイナリ
   - Windows用バイナリ
   - Linux用バイナリ

2. **パフォーマンス測定**
   - メモリ使用量測定
   - 検索速度ベンチマーク
   - 大量ファイル処理テスト

3. **リリース準備**
   - インストーラー作成
   - ユーザーマニュアル作成
   - リリースノート作成

### テスト不合格時
1. 問題の詳細を記録
2. 開発チームに報告
3. 修正後、再テスト実施

---

## 📝 参考情報

### デバッグ情報の収集

#### ログファイルの場所
- **Linux**: `~/.local/share/cocofile/cocofile.log`
- **macOS**: `~/Library/Application Support/cocofile/cocofile.log`
- **Windows**: `%APPDATA%\cocofile\cocofile.log`

#### コンソールログの確認
開発者ツール（F12）のConsoleタブでエラーを確認

#### データベースの確認
```bash
# データベースファイルの場所
ls ~/.local/share/cocofile/cocofile.db  # Linux
ls ~/Library/Application\ Support/cocofile/cocofile.db  # macOS
ls %APPDATA%\cocofile\cocofile.db  # Windows
```

---

## 🔗 関連ドキュメント

- [SETUP.md](../SETUP.md) - 環境構築ガイド
- [README.md](../README.md) - プロジェクト概要
- [MVP_100_COMPLETION.md](./MVP_100_COMPLETION.md) - MVP達成レポート
- [INTEGRATION_TEST_REPORT.md](./INTEGRATION_TEST_REPORT.md) - 統合テストレポート
- [FRONTEND_COMPLETION_REPORT.md](./FRONTEND_COMPLETION_REPORT.md) - フロントエンド完了レポート

---

**作成日**: 2025年11月5日
**最終更新**: 2025年11月5日
**ステータス**: 初版作成完了
**次回更新**: テスト実施後
